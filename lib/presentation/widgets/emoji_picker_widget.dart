import 'package:flutter/material.dart';

class EmojiPickerWidget extends StatefulWidget {
  final Function(String) onEmojiSelected;

  const EmojiPickerWidget({super.key, required this.onEmojiSelected});

  @override
  State<EmojiPickerWidget> createState() => _EmojiPickerWidgetState();
}

class _EmojiPickerWidgetState extends State<EmojiPickerWidget> {
  int _selectedCategory = 0;
  final PageController _pageController = PageController();

  // Danh sÃ¡ch emoji phá»• biáº¿n Ä‘Æ°á»£c phÃ¢n loáº¡i
  static const List<List<String>> _emojiCategories = [
    // Smileys & People
    [
      'ðŸ˜€',
      'ðŸ˜ƒ',
      'ðŸ˜„',
      'ðŸ˜',
      'ðŸ˜†',
      'ðŸ˜…',
      'ðŸ¤£',
      'ðŸ˜‚',
      'ðŸ™‚',
      'ðŸ™ƒ',
      'ðŸ˜‰',
      'ðŸ˜Š',
      'ðŸ˜‡',
      'ðŸ¥°',
      'ðŸ˜',
      'ðŸ¤©',
      'ðŸ˜˜',
      'ðŸ˜—',
      'ðŸ˜š',
      'ðŸ˜™',
      'ðŸ˜‹',
      'ðŸ˜›',
      'ðŸ˜œ',
      'ðŸ¤ª',
      'ðŸ˜',
      'ðŸ¤‘',
      'ðŸ¤—',
      'ðŸ¤­',
      'ðŸ¤«',
      'ðŸ¤”',
      'ðŸ¤',
      'ðŸ¤¨',
      'ðŸ˜',
      'ðŸ˜‘',
      'ðŸ˜¶',
      'ðŸ˜',
      'ðŸ˜’',
      'ðŸ™„',
      'ðŸ˜¬',
      'ðŸ¤¥',
      'ðŸ˜Œ',
      'ðŸ˜”',
      'ðŸ˜ª',
      'ðŸ¤¤',
      'ðŸ˜´',
      'ðŸ˜·',
      'ðŸ¤’',
      'ðŸ¤•',
      'ðŸ¤¢',
      'ðŸ¤®',
      'ðŸ¤§',
      'ðŸ¥µ',
      'ðŸ¥¶',
      'ðŸ˜µ',
      'ðŸ¤¯',
      'ðŸ¤ ',
      'ðŸ¥³',
      'ðŸ˜Ž',
      'ðŸ¤“',
      'ðŸ§',
      'ðŸ˜•',
      'ðŸ˜Ÿ',
      'ðŸ™',
      'â˜¹ï¸',
      'ðŸ˜®',
      'ðŸ˜¯',
      'ðŸ˜²',
      'ðŸ˜³',
      'ðŸ¥º',
      'ðŸ˜¦',
      'ðŸ˜§',
      'ðŸ˜¨',
      'ðŸ˜°',
      'ðŸ˜¥',
      'ðŸ˜¢',
      'ðŸ˜­',
      'ðŸ˜±',
      'ðŸ˜–',
      'ðŸ˜£',
      'ðŸ˜ž',
      'ðŸ˜“',
      'ðŸ˜©',
      'ðŸ˜«',
      'ðŸ¥±',
      'ðŸ˜¤',
      'ðŸ˜¡',
      'ðŸ˜ ',
      'ðŸ¤¬',
      'ðŸ˜ˆ',
      'ðŸ‘¿',
    ],
    // Gestures & Body Parts
    [
      'ðŸ‘‹',
      'ðŸ¤š',
      'ðŸ–ï¸',
      'âœ‹',
      'ðŸ––',
      'ðŸ‘Œ',
      'ðŸ¤Œ',
      'ðŸ¤',
      'âœŒï¸',
      'ðŸ¤ž',
      'ðŸ¤Ÿ',
      'ðŸ¤˜',
      'ðŸ¤™',
      'ðŸ‘ˆ',
      'ðŸ‘‰',
      'ðŸ‘†',
      'ðŸ–•',
      'ðŸ‘‡',
      'â˜ï¸',
      'ðŸ‘',
      'ðŸ‘Ž',
      'âœŠ',
      'ðŸ‘Š',
      'ðŸ¤›',
      'ðŸ¤œ',
      'ðŸ‘',
      'ðŸ™Œ',
      'ðŸ‘',
      'ðŸ¤²',
      'ðŸ¤',
      'ðŸ™',
      'âœï¸',
      'ðŸ’ª',
      'ðŸ¦¾',
      'ðŸ¦¿',
      'ðŸ¦µ',
      'ðŸ¦¶',
      'ðŸ‘‚',
      'ðŸ¦»',
      'ðŸ‘ƒ',
      'ðŸ‘€',
      'ðŸ‘ï¸',
      'ðŸ‘…',
      'ðŸ‘„',
      'ðŸ’‹',
    ],
    // Hearts & Emotions
    [
      'â¤ï¸',
      'ðŸ§¡',
      'ðŸ’›',
      'ðŸ’š',
      'ðŸ’™',
      'ðŸ’œ',
      'ðŸ–¤',
      'ðŸ¤',
      'ðŸ¤Ž',
      'ðŸ’”',
      'â£ï¸',
      'ðŸ’•',
      'ðŸ’ž',
      'ðŸ’“',
      'ðŸ’—',
      'ðŸ’–',
      'ðŸ’˜',
      'ðŸ’',
      'ðŸ’Ÿ',
    ],
    // Objects & Symbols
    [
      'ðŸ’¯',
      'ðŸ’¢',
      'ðŸ’¥',
      'ðŸ’«',
      'ðŸ’¦',
      'ðŸ’¨',
      'ðŸ•³ï¸',
      'ðŸ’£',
      'ðŸ’¬',
      'ðŸ‘ï¸â€ðŸ—¨ï¸',
      'ðŸ—¨ï¸',
      'ðŸ—¯ï¸',
      'ðŸ’­',
      'ðŸ’¤',
      'ðŸ”¥',
      'â­',
      'ðŸŒŸ',
      'âœ¨',
      'âš¡',
      'â˜„ï¸',
      'ðŸ’¥',
      'ðŸ’¢',
      'ðŸ’«',
      'ðŸ’¦',
      'ðŸ’¨',
      'ðŸ•³ï¸',
      'ðŸ’£',
      'ðŸ’¬',
      'ðŸ‘ï¸â€ðŸ—¨ï¸',
    ],
    // Food & Drink
    [
      'ðŸŽ',
      'ðŸŠ',
      'ðŸ‹',
      'ðŸŒ',
      'ðŸ‰',
      'ðŸ‡',
      'ðŸ“',
      'ðŸˆ',
      'ðŸ’',
      'ðŸ‘',
      'ðŸ¥­',
      'ðŸ',
      'ðŸ¥¥',
      'ðŸ¥',
      'ðŸ…',
      'ðŸ†',
      'ðŸ¥‘',
      'ðŸ¥¦',
      'ðŸ¥¬',
      'ðŸ¥’',
      'ðŸŒ¶ï¸',
      'ðŸŒ½',
      'ðŸ¥•',
      'ðŸ¥”',
      'ðŸ ',
      'ðŸ¥',
      'ðŸ¥¯',
      'ðŸž',
      'ðŸ¥–',
      'ðŸ¥¨',
      'ðŸ§€',
      'ðŸ¥š',
      'ðŸ³',
      'ðŸ¥ž',
      'ðŸ¥“',
      'ðŸ¥©',
      'ðŸ—',
      'ðŸ–',
      'ðŸŒ­',
      'ðŸ”',
      'ðŸŸ',
      'ðŸ•',
      'ðŸ¥ª',
      'ðŸ¥™',
      'ðŸŒ®',
      'ðŸŒ¯',
      'ðŸ¥—',
      'ðŸ¥˜',
      'ðŸ¥«',
      'ðŸ',
      'ðŸœ',
      'ðŸ²',
      'ðŸ›',
      'ðŸ£',
      'ðŸ±',
      'ðŸ¥Ÿ',
      'ðŸ¤',
      'ðŸ™',
      'ðŸš',
      'ðŸ˜',
      'ðŸ¥',
      'ðŸ¥ ',
      'ðŸ¢',
      'ðŸ¡',
      'ðŸ§',
      'ðŸ¨',
      'ðŸ¦',
      'ðŸ¥§',
      'ðŸ°',
      'ðŸŽ‚',
      'ðŸ®',
      'ðŸ­',
      'ðŸ¬',
      'ðŸ«',
      'ðŸ¿',
      'ðŸ©',
      'ðŸª',
      'ðŸŒ°',
      'ðŸ¥œ',
      'ðŸ¯',
      'ðŸ¥›',
      'ðŸ¼',
      'â˜•',
      'ðŸµ',
      'ðŸ¥¤',
      'ðŸ¶',
      'ðŸº',
      'ðŸ»',
      'ðŸ¥‚',
      'ðŸ·',
      'ðŸ¥ƒ',
      'ðŸ¸',
      'ðŸ¹',
      'ðŸ¾',
      'ðŸ§ƒ',
      'ðŸ§‰',
      'ðŸ§Š',
    ],
  ];

  @override
  void dispose() {
    _pageController.dispose();
    super.dispose();
  }

  @override
  Widget build(BuildContext context) {
    return Container(
      height: 300,
      color: Colors.white,
      child: Column(
        children: [
          // Tab bar cho cÃ¡c category
          Container(
            height: 40,
            decoration: BoxDecoration(
              color: Colors.black,
              border: Border(
                bottom: BorderSide(color: Colors.grey[300]!, width: 1),
              ),
            ),
            child: Row(
              children: [
                _buildCategoryTab(Icons.sentiment_satisfied, 0),
                _buildCategoryTab(Icons.thumb_up, 1),
                _buildCategoryTab(Icons.favorite, 2),
                _buildCategoryTab(Icons.star, 3),
                _buildCategoryTab(Icons.restaurant, 4),
              ],
            ),
          ),
          // Emoji grid
          Expanded(
            child: PageView.builder(
              controller: _pageController,
              itemCount: _emojiCategories.length,
              onPageChanged: (index) {
                setState(() {
                  _selectedCategory = index;
                });
              },
              itemBuilder: (context, categoryIndex) {
                return GridView.builder(
                  padding: const EdgeInsets.all(8),
                  gridDelegate: const SliverGridDelegateWithFixedCrossAxisCount(
                    crossAxisCount: 8,
                    crossAxisSpacing: 4,
                    mainAxisSpacing: 4,
                  ),
                  itemCount: _emojiCategories[categoryIndex].length,
                  itemBuilder: (context, index) {
                    final emoji = _emojiCategories[categoryIndex][index];
                    return InkWell(
                      onTap: () => widget.onEmojiSelected(emoji),
                      borderRadius: BorderRadius.circular(8),
                      child: Center(
                        child: Text(
                          emoji,
                          style: const TextStyle(fontSize: 28),
                        ),
                      ),
                    );
                  },
                );
              },
            ),
          ),
        ],
      ),
    );
  }

  Widget _buildCategoryTab(IconData icon, int index) {
    final isSelected = _selectedCategory == index;
    return Expanded(
      child: InkWell(
        onTap: () {
          _pageController.animateToPage(
            index,
            duration: const Duration(milliseconds: 300),
            curve: Curves.easeInOut,
          );
        },
        child: Container(
          alignment: Alignment.center,
          decoration: BoxDecoration(
            color: isSelected ? Colors.white : Colors.transparent,
            border: isSelected
                ? const Border(bottom: BorderSide(color: Colors.blue, width: 2))
                : null,
          ),
          child: Icon(
            icon,
            color: isSelected ? Colors.blue : Colors.white70,
            size: 24,
          ),
        ),
      ),
    );
  }
}
